# Involvement System

### Запуск сервиса локально
Для запуска сервиса необходимо:
* Установленная Java SDK не ниже 11 версии.
* Порт 5432 должен слушать PostgreSQL не ниже 9 версии
  (или изменить порт в [application.yml](src/main/resources/application.yml))
* Должна быть создана пустая база данных involvement_db
  (или изменить имя базы данных в [application.yml](src/main/resources/application.yml))
* Репозиторий фронтэнда находится по адресу https://github.com/Rinat-Arifullin/MORE.Tech4.0

Порядок действий:

Очистить старые версии и сгенерировать код по спецификации

```mvn clean compile```

Собрать и запустить сервис

```mvn spring-boot:run -D"spring-boot.run.profiles"=local```

Сервис будет доступен на порту 8091

После запуска сервиса документацию API доступна 
по ссылке http://localhost:8091/swagger-ui.html

Так же документация API доступна в yaml-формате [api-doc.yml](src/main/resources/static/api-doc.yml)

Ctrl + C завершение работы.

### Запуск сервиса в docker-контейнерах (docker-compose)

Для запуска в контейнерах на компьютере должны быть установлены docker и docker-compose.

Создать необходимые образы, создать и запустить контейнеры

```docker-compose up```

В результате будут созданы docker-образы involvement-system и postgres:12-alpine,
созданы и запущены контейнеры involvement-system-app и involvement-system-postgres.

Ctrl + C завершение работы.

Повторный запуск контейнеров 

```docker start involvement-system-postgres```

с выводом логов

```docker start -а involvement-system-app```

Остановка контейнеров (из другого командного окна) 

```docker stop involvement-system-app```

```docker stop involvement-system-postgres```

### Используемые технологии
* Java 11
* Spring Boot
* Spring Data JPA
* Maven
* PostgreSQL
* Liquibase
* OpenAPI

### Идея сервиса
Создать гильдии по профессиям: менеджмент, QA, front, back, devops и пр. 
В гильдии по 3 уровня. Есть шкала рейтингов. 
Для перехода на уровень выше нужно заработать рейтинг 
и подтверждать его каждые 2 месяца. 
Если 2 месяца уровень не подтверждается - перевод на уровень ниже. 
Нахождение на высоких уровнях говорит о квалификации сотрудника 
и дает возможность выполнять более "дорогие" задания. 
Монеты и рейтинг начисляются за выполнение заданий/активностей: 
помощь, менторинг, курс, оптимизация, генерация идей и пр. 
Задания/активности и их стоимость меняются в зависимости от нужд компании.

### Роли

**ADMIN** Администратор управляет пользователями системы, 
наполняет и изменяет справочную информацию, 
начисляет монеты и рейтинг за активности / выполнение заданий.  

**MANAGER** Руководитель начисляет монеты и рейтинг за выполнение заданий.
Публикует мероприятия.
Создает задания, одобряет задания (переводит в состояние План),
подтверждает выполнение заданий.

**HR MANAGER** Эйч-ар публикует мероприятия.
Создает и назначает задания. 
Начисляет монеты и рейтинг за активности / выполнение заданий.

**USER** Пользователь системы / участник системы вовлеченности.
"Зарабатывает" монеты и рейтинг выполняя задания.

### Идеи реализации
* Сервис является бэкэндом для работы с вовлеченностью сотрудников компании.
* Пользователи непосредственно работают с фронтэндом, 
который посредством Http-запросов обращается к бэкэнду,
где выполняются необходимые действия и возвращаются
запрошенные данные.
* Сервис соответствует REST API, что позволяет интегрироваться
с фронтэндом и предоставлять API другими приложениями.
* Для документирования API, генерации интерфейсов API и DTO используется OpenAPI
  (см. [api-doc.yml](src/main/resources/static/api-doc.yml)).
* Реализована многослойная архитектура приложения.
  (см. [interaction-scheme](files/interaction-scheme.md))
* Для хранения данных (см. [database-scheme](files/database-scheme.md)) 
используется база данных PostgresSQL.
* Миграция данных осуществляется с помощью Liquibase: создаются таблицы 
и заполняются тестовыми данными из файлов *.csv. 
* Для запуска в продуктив загрузку тестовых данных можно отключить 
или заменить на загрузку реальных данных.
* Для оптимальности/эффективности запросов,
избежания запросов в цикле 
используются проекции и нативные запросы.
Простота и удобство JPA используется для очевидных случаев.
* Справочник Users имеет две витрины: 
users - для "админки" и личного профиля,
members - для функций системы вовлеченности.
* Для работы с криптовалютой существует уже реализованный сервис.
Прямая работа фронтэнда с сервисом криптовалюты не предусматривается. 
Фронтэнд взаимодействует с данным сервисом, 
который выполняет необходимые запросы к сервису криптовалюты.
